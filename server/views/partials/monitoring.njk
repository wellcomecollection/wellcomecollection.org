<script src="https://cdn.ravenjs.com/3.25.2/raven.min.js" async onload="setupMonitoring()"></script>
<script>
  function setupMonitoring() {
    var oldSafari = /^.*Version\/[0-8].*Safari.*$/;
    var bingPreview = /^.*BingPreview.*$/;

    var ignoredUserAgentRegex = [
      oldSafari,
      bingPreview
    ];

    function shouldIgnore(regexArray, stringToMatch) {
      return regexArray.some(function(regex) {
        return regex.test(stringToMatch);
      });
    }

    var shouldIgnoreBrowsers = shouldIgnore(ignoredUserAgentRegex, window.navigator.userAgent);

    Raven.config('https://f756b8d4b492473782987a054aa9a347@sentry.io/133634', {
      shouldSendCallback: function(data) {
        return !shouldIgnoreBrowsers;
      },
      whitelistUrls: [/wellcomecollection\.org/],
      ignoreErrors: [
        /Blocked a frame with origin/,
        /document\.getElementsByClassName\.ToString/ // https://github.com/SamsungInternet/support/issues/56
      ]
    }).install();
  }
</script>
